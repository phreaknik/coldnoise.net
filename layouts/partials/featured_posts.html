{{- $featuredPosts := where site.RegularPages "Params.featured" "==" true -}}
{{- if $featuredPosts -}}
{{- $featuredPosts = sort $featuredPosts "Params.featuredWeight" -}}
<section class="featured-posts">
  <header class="featured-header">
    <h2>Featured Posts</h2>
  </header>
  <div class="featured-grid">
    {{- range $featuredPosts -}}
    <article class="featured-entry">
      {{- $isHidden := (.Param "cover.hiddenInList") | default (.Param "cover.hidden") | default false -}}
      {{- partial "cover.html" (dict "cxt" . "IsSingle" false "isHidden" $isHidden) -}}
      <div class="featured-content">
        <header class="featured-entry-header">
          <h3>
            <a href="{{ .Permalink }}" class="featured-title-link">{{ .Title }}</a>
          </h3>
        </header>
        {{- if (ne (.Param "hideSummary") true) -}}
        <div class="featured-summary">
          <p>{{ .Summary | plainify | htmlUnescape | truncate 120 }}{{ if .Truncated }}...{{ end }}</p>
        </div>
        {{- end -}}
        {{- if not (.Param "hideMeta") -}}
        <footer class="featured-meta">
          {{- partial "post_meta.html" . -}}
        </footer>
        {{- end -}}
      </div>
    </article>
    {{- end -}}
  </div>
</section>
{{- end -}}